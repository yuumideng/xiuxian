# 战斗属性系统 V2.0

## 📐 核心公式

```
result = 基础值 × (1 + 境界系数) × (1 + 加成) × (1 + 轮回加成) × (1 + 战斗倍率)
```

## 🎯 参数设定

### 1. 境界系数
- **计算公式**：`Math.floor((level - 1) / 10) + 1`
- **规则**：每个大境界（10级）境界系数+1
- **示例**：
  - 练气（1-10级）：境界系数 = 1
  - 筑基（11-20级）：境界系数 = 2
  - 金丹（21-30级）：境界系数 = 3
  - 元婴（31-40级）：境界系数 = 4
  - 以此类推...

### 2. 加成
- **当前值**：1000（暂时写死）
- **说明**：后续会设计多维度加成系统
- **预期来源**：
  - 天赋加成
  - 灵根加成
  - 装备加成
  - 功法加成
  - 丹药加成
  - 等等...

### 3. 轮回加成
- **当前值**：0
- **说明**：后续设计轮回系统时启用

### 4. 战斗倍率
- **当前值**：0
- **说明**：后续设计战斗相关倍率系统时启用

## 📊 基础属性值

| 属性 | 基础值 | 说明 |
|------|--------|------|
| 攻击 | 20 | 物理伤害基础值 |
| 闪避 | 20 | 躲避攻击的概率 |
| 防御 | 10 | 减少受到的伤害 |
| 血量 | 100 | 生命值，归零则战斗失败 |
| 速度 | 100 | 决定出手顺序 |
| 暴击 | 100 | 暴击率和暴击伤害 |
| 韧性 | 100 | 抵抗暴击和控制效果 |
| 命中 | 100 | 命中目标的概率 |

## 💪 战斗力计算

战斗力是综合所有属性的评估值，不同属性有不同权重：

```javascript
战斗力 = 攻击×0.28 + 防御×0.28 + 血量×0.20 + 速度×0.06 + 暴击×0.06 + 韧性×0.06 + 闪避×0.03 + 命中×0.03
```

### 权重分配逻辑

| 类别 | 属性 | 权重 | 总占比 | 说明 |
|------|------|------|--------|------|
| 核心输出 | 攻击 | 28% | 28% | 决定伤害能力 |
| 核心生存 | 防御 | 28% | 28% | 决定防御能力 |
| 次要生存 | 血量 | 20% | 20% | 提供容错空间 |
| 机动属性 | 速度 | 6% | 24% | 影响战斗节奏 |
| 机动属性 | 暴击 | 6% | | 提升输出上限 |
| 机动属性 | 韧性 | 6% | | 提升生存能力 |
| 机动属性 | 闪避 | 3% | | 增加生存概率 |
| 机动属性 | 命中 | 3% | | 保证输出稳定 |

## 📈 成长规律

### 大境界成长

由于境界系数每大境界+1，属性成长呈现**线性增长**特征：

```
练气（境界系数=1）：总倍率 = (1+1) × (1+1000) × 1 × 1 = 2002
筑基（境界系数=2）：总倍率 = (1+2) × (1+1000) × 1 × 1 = 3003
金丹（境界系数=3）：总倍率 = (1+3) × (1+1000) × 1 × 1 = 4004
元婴（境界系数=4）：总倍率 = (1+4) × (1+1000) × 1 × 1 = 5005
```

**倍率关系**：
- 筑基 / 练气 = 3003 / 2002 ≈ **1.50倍**
- 金丹 / 筑基 = 4004 / 3003 ≈ **1.33倍**
- 元婴 / 金丹 = 5005 / 4004 ≈ **1.25倍**

### 小境界成长

在同一个大境界内（如练气1-10级），境界系数保持不变，因此：
- **所有小境界的属性完全相同**
- **战斗力完全相同**

这意味着：
- 练气1层 = 练气10层（属性相同）
- 筑基初期 = 筑基大圆满（属性相同）
- 突破到下一个大境界时，属性会有显著提升

## 🎮 实际数值示例

### 练气境界（1-10级）

| 等级 | 境界系数 | 总倍率 | 攻击 | 防御 | 血量 | 战斗力 |
|------|----------|--------|------|------|------|--------|
| 1级 | 1 | 2002 | 40,040 | 20,020 | 200,200 | 50,050 |
| 5级 | 1 | 2002 | 40,040 | 20,020 | 200,200 | 50,050 |
| 10级 | 1 | 2002 | 40,040 | 20,020 | 200,200 | 50,050 |

### 筑基境界（11-20级）

| 等级 | 境界系数 | 总倍率 | 攻击 | 防御 | 血量 | 战斗力 |
|------|----------|--------|------|------|------|--------|
| 11级 | 2 | 3003 | 60,060 | 30,030 | 300,300 | 75,075 |
| 15级 | 2 | 3003 | 60,060 | 30,030 | 300,300 | 75,075 |
| 20级 | 2 | 3003 | 60,060 | 30,030 | 300,300 | 75,075 |

### 金丹境界（21-30级）

| 等级 | 境界系数 | 总倍率 | 攻击 | 防御 | 血量 | 战斗力 |
|------|----------|--------|------|------|------|--------|
| 21级 | 3 | 4004 | 80,080 | 40,040 | 400,400 | 100,100 |
| 25级 | 3 | 4004 | 80,080 | 40,040 | 400,400 | 100,100 |
| 30级 | 3 | 4004 | 80,080 | 40,040 | 400,400 | 100,100 |

### 元婴境界（31-40级）

| 等级 | 境界系数 | 总倍率 | 攻击 | 防御 | 血量 | 战斗力 |
|------|----------|--------|------|------|------|--------|
| 31级 | 4 | 5005 | 100,100 | 50,050 | 500,500 | 125,125 |
| 35级 | 4 | 5005 | 100,100 | 50,050 | 500,500 | 125,125 |
| 40级 | 4 | 5005 | 100,100 | 50,050 | 500,500 | 125,125 |

## 🔮 后续扩展方向

### 1. 加成系统设计

将"加成"参数从固定值1000改为动态计算：

```javascript
加成 = 天赋加成 + 灵根加成 + 装备加成 + 功法加成 + 丹药加成 + ...
```

**示例**：
- 天赋加成：气感×10 + 神识×10 + 根骨×10 + 悟性×10 + 机缘×10
- 灵根加成：总灵根值 × 5
- 装备加成：所有装备属性加成之和
- 功法加成：修炼功法等级 × 50
- 丹药加成：临时增益效果

### 2. 轮回系统设计

```javascript
轮回加成 = 轮回次数 × 轮回系数
```

**示例**：
- 第1次轮回：轮回加成 = 1 × 100 = 100
- 第2次轮回：轮回加成 = 2 × 100 = 200
- 第3次轮回：轮回加成 = 3 × 100 = 300

### 3. 战斗倍率系统设计

```javascript
战斗倍率 = 战斗经验影响 + 战斗技能加成 + 战斗状态加成
```

**示例**：
- 战斗经验影响：Math.log10(combat + 1) / 100
- 战斗技能加成：已学习技能数量 × 0.1
- 战斗状态加成：临时战斗buff效果

### 4. 小境界差异化

如果希望小境界也有属性差异，可以考虑：

**方案A：小境界系数**
```javascript
小境界系数 = (level - 1) % 10 / 10
总倍率 = (1 + 境界系数 + 小境界系数) × (1 + 加成) × ...
```

**方案B：小境界加成**
```javascript
小境界加成 = ((level - 1) % 10) × 10
总倍率 = (1 + 境界系数) × (1 + 加成 + 小境界加成) × ...
```

## 🎯 设计优势

1. **公式简洁**：易于理解和计算
2. **扩展性强**：预留了多个扩展参数
3. **平衡性好**：大境界有明显提升，但不会过于夸张
4. **真实感强**：符合修仙逐步变强的逻辑
5. **可控性高**：通过调整参数可以灵活控制成长速度

## 📝 注意事项

1. **当前小境界无差异**：同一大境界内所有小境界属性相同
2. **加成影响巨大**：加成参数对最终属性影响很大，需要仔细设计
3. **后续参数预留**：轮回加成和战斗倍率目前为0，后续启用时需要平衡测试
4. **战斗力权重**：如果调整权重，需要重新评估战斗力的合理性

## 🚀 使用示例

```javascript
import { calculateBattleAttributes, calculatePower, getRealmCoefficient } from '@/utils/battleCalculator.js'

// 计算玩家属性
const player = { level: 15, combat: 1000000 }
const attributes = calculateBattleAttributes(player)
const power = calculatePower(attributes)

console.log('境界系数:', getRealmCoefficient(player.level))
console.log('八大属性:', attributes)
console.log('战斗力:', power)
```

---

**版本**：2.0.0  
**更新日期**：2025-10-30  
**作者**：AI Assistant
